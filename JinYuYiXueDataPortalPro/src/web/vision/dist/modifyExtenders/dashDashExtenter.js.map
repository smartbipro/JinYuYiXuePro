{"version":3,"file":"dashDashExtenter.js","sources":["../../../../src/plugins/modifyExtenders/dashDashExtenter/DashExtenter.js","../../../../src/plugins/modifyExtenders/dashDashExtenter/index.js"],"sourcesContent":["import SmartBIExt from 'smartbi-ext'\r\n\r\nlet {\r\n    DashModule: {\r\n        DashEventEmum: {\r\n            DASHBOARD_ON_SAVE_DIALOG_INIT\r\n        },\r\n        BaseDashExtender\r\n    },\r\n    AugmentModule: {\r\n        AugmentEventEmum: {\r\n            AUGMENTEDDATASET_ON_TOOLBAR_INIT\r\n        },\r\n        BaseAugmentExtender\r\n    },\r\n    ModelQueryModule: {\r\n        ModelQueryEventEnum: {\r\n            MODEL_QUERY_ON_SAVE_DIALOG_INIT\r\n        },\r\n        BaseModelQueryExtender\r\n    },\r\n    Utils: {\r\n        ExtensionUtil: {rmi}\r\n    }\r\n} = SmartBIExt\r\n\r\nclass DashExtenter extends BaseDashExtender {\r\n    async install() {\r\n\t\tdebugger;\r\n        // 获取配置的参数列表\r\n        let resp = await rmi('XinSenZhiNengModule', 'isIntegration');\r\n        console.info(\"获取当前参数：\" + resp.result);\r\n        if (resp.result == null || resp.result == \"\") {\r\n            return;\r\n        }\r\n        let params = JSON.parse(resp.result);\r\n\r\n        //限制仪表盘保存目录\r\n        this.on(DASHBOARD_ON_SAVE_DIALOG_INIT, (iSaveDialog) => {\r\n            if (params && params.isIntegration && params.isIntegration == \"true\" && params.reportDefaultPath) {\r\n                let reportDefaultPath = params.reportDefaultPath;\r\n                iSaveDialog.setRootNodeId(reportDefaultPath);\r\n                // 删除所有操作按钮\r\n                iSaveDialog.setOperateButtonFilter(item => {\r\n                    return false\r\n                })\r\n            }\r\n        })\r\n\r\n        //限制即席查询保存目录\r\n        this.on(MODEL_QUERY_ON_SAVE_DIALOG_INIT, (iSaveDialog) => {\r\n            if (params && params.isIntegration && params.isIntegration == \"true\" && params.reportDefaultPath) {\r\n                let reportDefaultPath = params.reportDefaultPath;\r\n                iSaveDialog.setRootNodeId(reportDefaultPath);\r\n                // 删除所有操作按钮\r\n                iSaveDialog.setOperateButtonFilter(item => {\r\n                    return false\r\n                })\r\n            }\r\n        })\r\n\r\n        //屏蔽数据模型另存为操作\r\n        this.on(AUGMENTEDDATASET_ON_TOOLBAR_INIT, (iToolbar) => {\r\n            if (params && params.isIntegration == \"true\" && params.forbidDataSaveAs == \"true\") {\r\n                // 获取按钮配置\r\n                let btns = iToolbar.getButtons();\r\n                for (let i = 0; i < btns.length; i++) {\r\n                    if (btns[i].action === 'SAVE') {\r\n                        // 移除save的子菜单\r\n                        btns[i].children = [];\r\n                        // 去掉下拉图标\r\n                        btns[i].type = 'icon';\r\n                    }\r\n                }\r\n            }\r\n        })\r\n    }\r\n}\r\n\r\nexport default DashExtenter","import DashExtenter from './DashExtenter'\r\nconst provideMetaInfo = () => {\r\n    // 二开文件\r\n    return { implement: DashExtenter}\r\n}\r\nexport default {\r\n    provideMetaInfo\r\n}"],"names":["SmartBIExt","DashModule","DASHBOARD_ON_SAVE_DIALOG_INIT","DashEventEmum","BaseDashExtender","AugmentModule","AUGMENTEDDATASET_ON_TOOLBAR_INIT","AugmentEventEmum","BaseAugmentExtender","ModelQueryModule","MODEL_QUERY_ON_SAVE_DIALOG_INIT","ModelQueryEventEnum","rmi","BaseModelQueryExtender","Utils","ExtensionUtil","DashExtenter","resp","console","info","result","params","JSON","parse","on","iSaveDialog","isIntegration","reportDefaultPath","setRootNodeId","setOperateButtonFilter","item","iToolbar","forbidDataSaveAs","btns","getButtons","i","length","action","children","type","provideMetaInfo","implement"],"mappings":"42CAEA,MAsBIA,EArBAC,WAEQC,IADJC,cACID,8BAEJE,IAAAA,mBAiBJJ,EAfAK,cAEQC,IADJC,iBACID,sCAEJE,oBAWJR,EATAS,kBAEQC,IADJC,oBACID,gCAKYE,KAHhBC,uBAKJb,EAHAc,MACIC,cAAgBH,KAIlBI,uSAAqBZ,uPACvB,oHAGqBQ,EAAI,sBAAuB,2BAAxCK,SACJC,QAAQC,KAAK,UAAYF,EAAKG,QACX,MAAfH,EAAKG,QAAiC,IAAfH,EAAKG,wDAG5BC,EAASC,KAAKC,MAAMN,EAAKG,aAGxBI,GAAGtB,EAA+B,SAACuB,MAChCJ,GAAUA,EAAOK,eAAyC,QAAxBL,EAAOK,eAA2BL,EAAOM,kBAAmB,KAC1FA,EAAoBN,EAAOM,kBAC/BF,EAAYG,cAAcD,GAE1BF,EAAYI,uBAAuB,SAAAC,UACxB,YAMdN,GAAGd,EAAiC,SAACe,MAClCJ,GAAUA,EAAOK,eAAyC,QAAxBL,EAAOK,eAA2BL,EAAOM,kBAAmB,KAC1FA,EAAoBN,EAAOM,kBAC/BF,EAAYG,cAAcD,GAE1BF,EAAYI,uBAAuB,SAAAC,UACxB,YAMdN,GAAGlB,EAAkC,SAACyB,MACnCV,GAAkC,QAAxBA,EAAOK,eAAsD,QAA3BL,EAAOW,yBAE/CC,EAAOF,EAASG,aACXC,EAAI,EAAGA,EAAIF,EAAKG,OAAQD,IACN,SAAnBF,EAAKE,GAAGE,SAERJ,EAAKE,GAAGG,SAAW,GAEnBL,EAAKE,GAAGI,KAAO,6XClExB,CACXC,gBALoB,iBAEb,CAAEC,UAAWzB"}